<div class="admin-container">
    <div class="form-header">
        <button class="back-link" (click)="goBack()">
            <span class="material-icons-round">arrow_back</span>
            Voltar
        </button>
        <h1>{{ isEditMode ? 'Editar Simulado' : 'Novo Simulado' }}</h1>
    </div>

    <div class="zen-card">
        <form [formGroup]="form" (ngSubmit)="save()">

            <!-- Seção 1: Informações Básicas -->
            <h3 class="section-title">Informações Básicas</h3>
            <div class="form-grid">
                <div class="form-group span-2">
                    <label class="zen-label">Título do Simulado <span class="required">*</span></label>
                    <input type="text" formControlName="title" class="zen-input" [class.error]="hasError('title')"
                        placeholder="Ex: Simulado ENEM 2024 - 1ª Aplicação">
                    <span class="error-msg" *ngIf="hasError('title')">{{getError('title')}}</span>
                </div>

                <div class="form-group span-2">
                    <label class="zen-label">Descrição</label>
                    <textarea formControlName="description" class="zen-input zen-textarea" rows="3"
                        placeholder="Descrição opcional do simulado"></textarea>
                </div>

                <div class="form-group">
                    <label class="zen-label">Tipo <span class="required">*</span></label>
                    <select formControlName="type" class="zen-select">
                        <option *ngFor="let t of examTypes" [ngValue]="t.value">{{t.label}}</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="zen-label">Duração (minutos) <span class="required">*</span></label>
                    <input type="number" formControlName="durationMinutes" class="zen-input"
                        [class.error]="hasError('durationMinutes')" placeholder="180">
                    <span class="error-msg" *ngIf="hasError('durationMinutes')">{{getError('durationMinutes')}}</span>
                </div>
            </div>

            <!-- Seção 2: Disponibilidade -->
            <h3 class="section-title mt-4">Disponibilidade</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label class="zen-label">Disponível a partir de</label>
                    <input type="date" formControlName="availableFrom" class="zen-input">
                    <small class="hint">Deixe vazio para disponível imediatamente</small>
                </div>

                <div class="form-group">
                    <label class="zen-label">Disponível até</label>
                    <input type="date" formControlName="availableUntil" class="zen-input">
                    <small class="hint">Deixe vazio para sem expiração</small>
                </div>
            </div>

            <!-- Seção 3: Configurações -->
            <h3 class="section-title mt-4">Configurações</h3>
            <div class="form-grid">
                <div class="form-group checkbox-group">
                    <label class="checkbox-container">
                        <input type="checkbox" formControlName="showCorrectAnswers">
                        <span class="checkmark"></span>
                        <span class="label-text">Mostrar gabarito após conclusão</span>
                    </label>
                </div>

                <div class="form-group checkbox-group">
                    <label class="checkbox-container">
                        <input type="checkbox" formControlName="randomizeQuestions">
                        <span class="checkmark"></span>
                        <span class="label-text">Embaralhar ordem das questões</span>
                    </label>
                </div>

                <div class="form-group checkbox-group">
                    <label class="checkbox-container">
                        <input type="checkbox" formControlName="randomizeOptions">
                        <span class="checkmark"></span>
                        <span class="label-text">Embaralhar alternativas</span>
                    </label>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="zen-btn zen-btn--secondary" (click)="goBack()"
                    [disabled]="saving">Cancelar</button>
                <button type="submit" class="zen-btn zen-btn--primary" [disabled]="saving || form.invalid">
                    <span class="material-icons-round" *ngIf="!saving">save</span>
                    <span class="spinner-sm" *ngIf="saving"></span>
                    {{ saving ? 'Salvando...' : 'Salvar Simulado' }}
                </button>
            </div>

        </form>
    </div>
</div>